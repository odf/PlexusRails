!!! Strict
%html{html_attrs}
  - stripped = request.xhr? || params[:stripped]

  %head
    %meta{"http-equiv"=>"Content-Type", :content=>"text/html; charset=utf-8"}/
    %title= h(yield(:title) || "Untitled")
    = csrf_meta_tag
    - unless stripped
      = stylesheet_link_tag 'application'
    = yield(:head)
  %body
    #page
      - unless stripped
        #navigation
          %ul
            %li= link_to "Projects", projects_url
        #header
          %img{ :src => "/images/grains-with-gradient.png", :alt => "" }
          #logo
            %img{ :src => "/images/logo-with-gradient.png", :alt => "PLEXUS" }
        .clear
  
      #status-line
        #time-display
          = Time.now
        #notice.dj-replace.dj-anchor
          - if flash[:notice]
            = h(flash[:notice]).gsub(/(.)\n(.)/, '\1<br />\2')
            - flash[:notice] = nil
      .clear
  
      #content
        - if show_title? and not stripped
          %h1= h(yield(:title) || "Untitled")
  
        #errors.dj-replace.dj-anchor
          - if flash[:error]
            #flash_error
              %pre= h(flash[:error])
              - flash[:error] = nil
          - elsif flash[:object_with_errors]
            = error_messages_for(flash[:object_with_errors])
  
        #raw-content.dj-context= yield
      .clear

      - unless stripped
        #footer
          - if ENV['RAILS_ENV'] == 'production'
            All rights reserved.
          - else
            Development version!
        .clear
